#!/bin/bash

# HERITRACE {{PACKAGE_TYPE_TITLE}} Testing - Stop Script
# Usage: ./stop.sh

set -e

echo "ğŸ›‘ Stopping HERITRACE {{PACKAGE_TYPE_TITLE}} Testing Environment"
echo "=============================================="

# Detect the correct Docker Compose command
detect_compose_cmd() {
    if docker compose version >/dev/null 2>&1; then
        echo "docker compose"
    elif docker-compose version >/dev/null 2>&1; then
        echo "docker-compose"
    else
        echo "âŒ Error: Docker Compose is not available!"
        echo "   Please ensure Docker Compose (v2) or docker-compose (v1) is installed and accessible."
        exit 1
    fi
}

COMPOSE_CMD=$(detect_compose_cmd)

# Stop and remove containers
echo "ğŸ³ Stopping Docker containers..."
$COMPOSE_CMD down

echo "âœ… All services stopped!"
echo ""
echo "ğŸ’¡ Your test data is preserved in Docker volumes."
echo "   To restart, simply run: ./start.sh"
echo ""
echo "ğŸ“ Once the test is complete, don't forget to export the results!"
{{EXPORT_MESSAGE}}
