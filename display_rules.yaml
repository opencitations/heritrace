- class: "http://purl.org/spar/fabio/JournalArticle"
  displayName: "Journal Article"
  displayProperties:
    - property: "http://www.w3.org/1999/02/22-rdf-syntax-ns#type"
      displayName: "Type"
      shouldBeDisplayed: true
    - property: "http://purl.org/spar/datacite/hasIdentifier"
      displayName: "Identifier"
      shouldBeDisplayed: true
      fetchValueFromQuery: |
            PREFIX datacite: <http://purl.org/spar/datacite/>
            PREFIX literal: <http://www.essepuntato.it/2010/06/literalreification/>
            SELECT (CONCAT(STRAFTER(STR(?scheme), "http://purl.org/spar/datacite/"), ":", ?literal) AS ?id) ?identifier
            WHERE {
                [[subject]] datacite:hasIdentifier ?identifier.
                BIND([[value]] AS ?identifier)
                ?identifier datacite:usesIdentifierScheme ?scheme;
                            literal:hasLiteralValue ?literal.
            }
    - property: "http://purl.org/dc/terms/title"
      displayName: "Title"
      shouldBeDisplayed: true
    - property: "http://purl.org/spar/pro/isDocumentContextFor"
      orderedBy: "https://w3id.org/oc/ontology/hasNext"
      intermediateRelation:
        class: "http://purl.org/spar/pro/RoleInTime"
        targetEntityType: "http://xmlns.com/foaf/0.1/Agent"
      displayRules:
        - shape: "http://schema.org/AuthorShape"
          displayName: "Author"
          fetchValueFromQuery: |
            PREFIX pro: <http://purl.org/spar/pro/>
            PREFIX foaf: <http://xmlns.com/foaf/0.1/>
            SELECT DISTINCT ?formattedName ?ra WHERE {
                [[value]] pro:isHeldBy ?ra;
                    pro:withRole pro:author.
                OPTIONAL { ?ra foaf:name ?name. }
                OPTIONAL { ?ra foaf:familyName ?familyName. }
                OPTIONAL { ?ra foaf:givenName ?givenName. }
                BIND(
                    IF(BOUND(?name), ?name,
                        IF(BOUND(?familyName) && BOUND(?givenName), CONCAT(?familyName, ", ", ?givenName),
                            IF(BOUND(?familyName), CONCAT(?familyName, ","), 
                                IF(BOUND(?givenName), CONCAT(",", ?givenName), "")
                            )
                        )
                    ) AS ?formattedName
                )
            }
        - shape: "http://schema.org/EditorShape"
          displayName: "Editor"
          fetchValueFromQuery: |
            PREFIX pro: <http://purl.org/spar/pro/>
            PREFIX foaf: <http://xmlns.com/foaf/0.1/>
            SELECT DISTINCT ?formattedName ?ra WHERE {
                [[value]] pro:isHeldBy ?ra;
                    pro:withRole pro:editor.
                OPTIONAL { ?ra foaf:name ?name. }
                OPTIONAL { ?ra foaf:familyName ?familyName. }
                OPTIONAL { ?ra foaf:givenName ?givenName. }
                BIND(
                    IF(BOUND(?name), ?name,
                        IF(BOUND(?familyName) && BOUND(?givenName), CONCAT(?familyName, ", ", ?givenName),
                            IF(BOUND(?familyName), CONCAT(?familyName, ","), 
                                IF(BOUND(?givenName), CONCAT(",", ?givenName), "")
                            )
                        )
                    ) AS ?formattedName
                )
            }
        - shape: "http://schema.org/PublisherShape"
          displayName: "Publisher"
          fetchValueFromQuery: |
            PREFIX pro: <http://purl.org/spar/pro/>
            PREFIX foaf: <http://xmlns.com/foaf/0.1/>
            SELECT DISTINCT ?formattedName ?ra WHERE {
                [[value]] pro:isHeldBy ?ra;
                    pro:withRole pro:publisher.
                OPTIONAL { ?ra foaf:name ?name. }
                OPTIONAL { ?ra foaf:familyName ?familyName. }
                OPTIONAL { ?ra foaf:givenName ?givenName. }
                BIND(
                    IF(BOUND(?name), ?name,
                        IF(BOUND(?familyName) && BOUND(?givenName), CONCAT(?familyName, ", ", ?givenName),
                            IF(BOUND(?familyName), CONCAT(?familyName, ","), 
                                IF(BOUND(?givenName), CONCAT(",", ?givenName), "")
                            )
                        )
                    ) AS ?formattedName
                )
            }
    - property: "http://prismstandard.org/namespaces/basic/2.0/publicationDate"
      displayName: "Publication Date"
      shouldBeDisplayed: true
    - property: "http://purl.org/vocab/frbr/core#embodiment"
      displayName: "Page"
      shouldBeDisplayed: true
      fetchValueFromQuery: |
          PREFIX frbr: <http://purl.org/vocab/frbr/core#>
          PREFIX prism: <http://prismstandard.org/namespaces/basic/2.0/>
          SELECT 
              (IF(BOUND(?startingPage) && BOUND(?endingPage), 
                  CONCAT(STR(?startingPage), "-", STR(?endingPage)), 
                  IF(BOUND(?startingPage), STR(?startingPage), 
                  IF(BOUND(?endingPage), STR(?endingPage), ""))) AS ?page) 
            ?re
          WHERE {
              [[subject]] frbr:embodiment ?re.
              OPTIONAL { ?re prism:startingPage ?startingPage. }
              OPTIONAL { ?re prism:endingPage ?endingPage. }
          }
    - property: "http://purl.org/vocab/frbr/core#partOf"
      displayRules:
        - shape: "http://schema.org/IssueShape"
          displayName: "Issue"
          fetchValueFromQuery: |
            PREFIX fabio: <http://purl.org/spar/fabio/>
            PREFIX frbr: <http://purl.org/vocab/frbr/core#>
            SELECT ?issueNumber ?issue
            WHERE {
                [[subject]] frbr:partOf ?issue.
                ?issue a fabio:JournalIssue;
                    fabio:hasSequenceIdentifier ?issueNumber.
            }
        - shape: "http://schema.org/VolumeShape"
          displayName: "Volume"
          fetchValueFromQuery: |
            PREFIX fabio: <http://purl.org/spar/fabio/>
            PREFIX frbr: <http://purl.org/vocab/frbr/core#>
            PREFIX foaf: <http://xmlns.com/foaf/0.1/>
            SELECT ?volumeNumber ?volume
            WHERE {
                [[subject]] frbr:partOf+ ?volume.
                ?volume a fabio:JournalVolume;
                    fabio:hasSequenceIdentifier ?volumeNumber.
            }
        - shape: "http://schema.org/JournalShape"
          displayName: "Journal"
          fetchValueFromQuery: |
            PREFIX fabio: <http://purl.org/spar/fabio/>
            PREFIX frbr: <http://purl.org/vocab/frbr/core#>
            PREFIX dcterms: <http://purl.org/dc/terms/>
            SELECT ?journalName ?journal
            WHERE {
                [[subject]] frbr:partOf+ ?journal.
                ?journal a fabio:Journal;
                    dcterms:title ?journalName.
            }

- class: "http://purl.org/spar/fabio/Journal"
  displayName: "Journal"
  displayProperties:
    - property: "http://www.w3.org/1999/02/22-rdf-syntax-ns#type"
      displayName: "Type"
      shouldBeDisplayed: true
    - property: "http://purl.org/spar/datacite/hasIdentifier"
      displayName: "Identifier"
      shouldBeDisplayed: true
      fetchValueFromQuery: |
            PREFIX datacite: <http://purl.org/spar/datacite/>
            PREFIX literal: <http://www.essepuntato.it/2010/06/literalreification/>
            SELECT (CONCAT(STRAFTER(STR(?scheme), "http://purl.org/spar/datacite/"), ":", ?literal) AS ?id) ?identifier
            WHERE {
                [[subject]] datacite:hasIdentifier ?identifier.
                BIND([[value]] AS ?identifier)
                ?identifier datacite:usesIdentifierScheme ?scheme;
                            literal:hasLiteralValue ?literal.
            }
    - property: "http://purl.org/dc/terms/title"
      displayName: "Title"
      shouldBeDisplayed: true

- class: "http://purl.org/spar/fabio/JournalVolume"
  displayName: "Volume"
  displayProperties:
    - property: "http://www.w3.org/1999/02/22-rdf-syntax-ns#type"
      displayName: "Type"
      shouldBeDisplayed: true
    - property: "http://purl.org/spar/fabio/hasSequenceIdentifier"
      displayName: "Number"
      shouldBeDisplayed: true
    - property: "http://purl.org/vocab/frbr/core#partOf"
      displayRules:
        - shape: "http://schema.org/JournalShape"
          displayName: "Journal"
          fetchValueFromQuery: |
            PREFIX fabio: <http://purl.org/spar/fabio/>
            PREFIX frbr: <http://purl.org/vocab/frbr/core#>
            PREFIX dcterms: <http://purl.org/dc/terms/>
            SELECT ?journalName ?journal
            WHERE {
                [[subject]] frbr:partOf ?journal.
                ?journal a fabio:Journal;
                    dcterms:title ?journalName.
            }

- class: "http://purl.org/spar/fabio/JournalIssue"
  displayName: "Issue"
  displayProperties:
    - property: "http://www.w3.org/1999/02/22-rdf-syntax-ns#type"
      displayName: "Type"
      shouldBeDisplayed: true
    - property: "http://purl.org/spar/fabio/hasSequenceIdentifier"
      displayName: "Number"
      shouldBeDisplayed: true
    - property: "http://purl.org/vocab/frbr/core#partOf"
      displayRules:
        - shape: "http://schema.org/VolumeShape"
          displayName: "Volume"
          fetchValueFromQuery: |
            PREFIX fabio: <http://purl.org/spar/fabio/>
            PREFIX frbr: <http://purl.org/vocab/frbr/core#>
            PREFIX foaf: <http://xmlns.com/foaf/0.1/>
            SELECT ?volumeNumber ?volume
            WHERE {
                [[subject]] frbr:partOf ?volume.
                ?volume a fabio:JournalVolume;
                    fabio:hasSequenceIdentifier ?volumeNumber.
            }
        - shape: "http://schema.org/JournalShape"
          displayName: "Journal"
          fetchValueFromQuery: |
            PREFIX fabio: <http://purl.org/spar/fabio/>
            PREFIX frbr: <http://purl.org/vocab/frbr/core#>
            PREFIX dcterms: <http://purl.org/dc/terms/>
            SELECT ?journalName ?journal
            WHERE {
                [[subject]] frbr:partOf+ ?journal.
                ?journal a fabio:Journal;
                    dcterms:title ?journalName.
            }

- class: "http://purl.org/spar/fabio/Book"
  displayName: "Book"
  displayProperties:
    - property: "http://www.w3.org/1999/02/22-rdf-syntax-ns#type"
      displayName: "Type"
      shouldBeDisplayed: true
    - property: "http://purl.org/spar/datacite/hasIdentifier"
      displayName: "Identifier"
      shouldBeDisplayed: true
      fetchValueFromQuery: |
            PREFIX datacite: <http://purl.org/spar/datacite/>
            PREFIX literal: <http://www.essepuntato.it/2010/06/literalreification/>
            SELECT (CONCAT(STRAFTER(STR(?scheme), "http://purl.org/spar/datacite/"), ":", ?literal) AS ?id) ?identifier
            WHERE {
                [[subject]] datacite:hasIdentifier ?identifier.
                BIND([[value]] AS ?identifier)
                ?identifier datacite:usesIdentifierScheme ?scheme;
                            literal:hasLiteralValue ?literal.
            }
    - property: "http://purl.org/dc/terms/title"
      displayName: "Title"
      shouldBeDisplayed: true
    - property: "http://purl.org/spar/pro/isDocumentContextFor"
      intermediateRelation:
        class: "http://purl.org/spar/pro/RoleInTime"
        targetEntityType: "http://xmlns.com/foaf/0.1/Agent"
      displayRules:
        - shape: "http://schema.org/AuthorShape"
          displayName: "Author"
          fetchValueFromQuery: |
            PREFIX pro: <http://purl.org/spar/pro/>
            PREFIX foaf: <http://xmlns.com/foaf/0.1/>
            SELECT DISTINCT ?formattedName ?ra WHERE {
                [[value]] pro:isHeldBy ?ra;
                    pro:withRole pro:author.
                OPTIONAL { ?ra foaf:name ?name. }
                OPTIONAL { ?ra foaf:familyName ?familyName. }
                OPTIONAL { ?ra foaf:givenName ?givenName. }
                BIND(
                    IF(BOUND(?name), ?name,
                        IF(BOUND(?familyName) && BOUND(?givenName), CONCAT(?familyName, ", ", ?givenName),
                            IF(BOUND(?familyName), CONCAT(?familyName, ","), 
                                IF(BOUND(?givenName), CONCAT(",", ?givenName), "")
                            )
                        )
                    ) AS ?formattedName
                )
            }
        - shape: "http://schema.org/EditorShape"
          displayName: "Editor"
          fetchValueFromQuery: |
            PREFIX pro: <http://purl.org/spar/pro/>
            PREFIX foaf: <http://xmlns.com/foaf/0.1/>
            SELECT DISTINCT ?formattedName ?ra WHERE {
                [[value]] pro:isHeldBy ?ra;
                    pro:withRole pro:editor.
                OPTIONAL { ?ra foaf:name ?name. }
                OPTIONAL { ?ra foaf:familyName ?familyName. }
                OPTIONAL { ?ra foaf:givenName ?givenName. }
                BIND(
                    IF(BOUND(?name), ?name,
                        IF(BOUND(?familyName) && BOUND(?givenName), CONCAT(?familyName, ", ", ?givenName),
                            IF(BOUND(?familyName), CONCAT(?familyName, ","), 
                                IF(BOUND(?givenName), CONCAT(",", ?givenName), "")
                            )
                        )
                    ) AS ?formattedName
                )
            }
        - shape: "http://schema.org/PublisherShape"
          displayName: "Publisher"
          fetchValueFromQuery: |
            PREFIX pro: <http://purl.org/spar/pro/>
            PREFIX foaf: <http://xmlns.com/foaf/0.1/>
            SELECT DISTINCT ?formattedName ?ra WHERE {
                [[value]] pro:isHeldBy ?ra;
                    pro:withRole pro:publisher.
                OPTIONAL { ?ra foaf:name ?name. }
                OPTIONAL { ?ra foaf:familyName ?familyName. }
                OPTIONAL { ?ra foaf:givenName ?givenName. }
                BIND(
                    IF(BOUND(?name), ?name,
                        IF(BOUND(?familyName) && BOUND(?givenName), CONCAT(?familyName, ", ", ?givenName),
                            IF(BOUND(?familyName), CONCAT(?familyName, ","), 
                                IF(BOUND(?givenName), CONCAT(",", ?givenName), "")
                            )
                        )
                    ) AS ?formattedName
                )
            }
      orderedBy: "https://w3id.org/oc/ontology/hasNext"
    - property: "http://prismstandard.org/namespaces/basic/2.0/publicationDate"
      displayName: "Publication Date"
      shouldBeDisplayed: true
    - property: "http://purl.org/vocab/frbr/core#embodiment"
      displayName: "Page"
      shouldBeDisplayed: true
      fetchValueFromQuery: |
          PREFIX frbr: <http://purl.org/vocab/frbr/core#>
          PREFIX prism: <http://prismstandard.org/namespaces/basic/2.0/>
          SELECT 
              (IF(BOUND(?startingPage) && BOUND(?endingPage), 
                  CONCAT(STR(?startingPage), "-", STR(?endingPage)), 
                  IF(BOUND(?startingPage), STR(?startingPage), 
                  IF(BOUND(?endingPage), STR(?endingPage), ""))) AS ?page) 
            ?re
          WHERE {
              [[subject]] frbr:embodiment ?re.
              OPTIONAL { ?re prism:startingPage ?startingPage. }
              OPTIONAL { ?re prism:endingPage ?endingPage. }
          }
    - property: "http://purl.org/vocab/frbr/core#partOf"
      displayName: "Container"
      shouldBeDisplayed: true

- class: "http://purl.org/spar/datacite/Identifier"
  displayName: "Identifier"
  displayProperties:
    - property: "http://www.w3.org/1999/02/22-rdf-syntax-ns#type"
      displayName: "Type"
      shouldBeDisplayed: true
    - property: "http://purl.org/spar/datacite/usesIdentifierScheme"
      displayName: "Identifier Scheme"
      shouldBeDisplayed: true
    - property: "http://www.essepuntato.it/2010/06/literalreification/hasLiteralValue"
      displayName: "Literal Value"
      shouldBeDisplayed: true

- class: "http://purl.org/spar/fabio/Manifestation"
  displayName: "Page"
  displayProperties:
    - property: "http://www.w3.org/1999/02/22-rdf-syntax-ns#type"
      displayName: "Type"
      shouldBeDisplayed: true
    - property: "http://purl.org/dc/terms/format"
      displayName: "Format"
      shouldBeDisplayed: true
    - property: "http://prismstandard.org/namespaces/basic/2.0/startingPage"
      displayName: "Starting Page"
      shouldBeDisplayed: true
    - property: "http://prismstandard.org/namespaces/basic/2.0/endingPage"
      displayName: "Ending Page"
      shouldBeDisplayed: true

- class: "http://xmlns.com/foaf/0.1/Agent"
  displayName: "Responsible Agent"
  displayProperties:
    - property: "http://www.w3.org/1999/02/22-rdf-syntax-ns#type"
      displayName: "Type"
      shouldBeDisplayed: true
    - property: "http://purl.org/spar/datacite/hasIdentifier"
      displayName: "Identifier"
      shouldBeDisplayed: true
      fetchValueFromQuery: |
            PREFIX datacite: <http://purl.org/spar/datacite/>
            PREFIX literal: <http://www.essepuntato.it/2010/06/literalreification/>
            SELECT (CONCAT(STRAFTER(STR(?scheme), "http://purl.org/spar/datacite/"), ":", ?literal) AS ?id) ?identifier
            WHERE {
                [[subject]] datacite:hasIdentifier ?identifier.
                BIND([[value]] AS ?identifier)
                ?identifier datacite:usesIdentifierScheme ?scheme;
                            literal:hasLiteralValue ?literal.
            }
    - property: "http://xmlns.com/foaf/0.1/name"
      displayName: "Name"
      shouldBeDisplayed: true
    - property: "http://xmlns.com/foaf/0.1/givenName"
      displayName: "Given Name"
      shouldBeDisplayed: true
    - property: "http://xmlns.com/foaf/0.1/familyName"
      displayName: "Family Name"
      shouldBeDisplayed: true